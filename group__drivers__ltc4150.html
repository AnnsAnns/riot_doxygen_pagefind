<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RIOT OS: LTC4150 coulomb counter</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<!-- <script type="text/javascript" src="jquery.js"></script> -->
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<!-- <link href="/pagefind/pagefind-ui.css" rel="stylesheet"> -->
<script src="/pagefind/pagefind-ui.js"></script>
<script>
  // Check whether the PagefindUI class is available
  if (typeof PagefindUI === 'undefined') {
    console.error('PagefindUI class is not available | Dev Build');
  } else {
    // // Remove the "searchstub" element and initialize the PagefindUI class
    // document.getElementById("#searchstub").remove();
    // Initialize the PagefindUI class with the element id "search"
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
  }
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="global.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <script>
    // Print the data within the NAVTREE variable from the navtreedata.js file
    var navtree = NAVTREE;
    console.log(navtree);
  </script>
<div class="flex flex-row gap-4 w-screen font-sans text-lg max-h-screen overscroll-contain justify-items-stretch bg-neutral-900">
  <!--Sidebar-->
  <div data-pagefind-ignore="all" class="w-1/3 max-w-md flex-auto h-screen bg-neutral-800 ring-2 ring-neutral-700 shadow-neutral-800 shadow-2xl rounded-xl p-3 ml-1 my-2 mr-3 flex flex-col justify-around">
    <div id="top" class="justify-self-center content-center items-center place-content-center">
      <img alt="Logo" src="riot-logo.svg"/>
      <div id="projectbrief">
        The friendly Operating System for the Internet of Things
      </div>
    </div>
    <div id="search" class="place-content-center" class="overflow-y-scroll max-h-64 bg-slate-400 ring-2 ring-white text-white" >
      <h1>Searchbar via Pagefind</h1>
      <!-- <div id="searchstub" class="flex items-center border border-gray-300 rounded-lg p-2 shadow-sm">
        <input type="text" placeholder="Search is only available in Production Build ..." class="flex-grow p-2 outline-none">
      </div> -->
    </div>
    <div id="navtree">
      <script>
        // The navtree variable is always a pair of two elements (key, value)
        // The key is the name we should display and the value is the link to the page
        // Generate the navtree from the navtreedata.js file and put it under the navtree div
        var navtree = NAVTREE[0][2];
        var navtreeHTML = "<h1>Navigation based on Doxygen</h1> <ul>";
        for (var i = 0; i < navtree.length; i++) {
          navtreeHTML += "<li><a href='" + navtree[i][1] + "'>" + navtree[i][0] + "</a></li>";
          if (i == 5) {
            navtreeHTML += '<li><h3 class="ring-2 ring-white"> Random Insert for Demonstration </h3></li>';
          }
        }
        navtreeHTML += "</ul>";
        document.getElementById("navtree").innerHTML = navtreeHTML;
      </script>
    </div>
    <ul>
      <li class="footer">
        Generated on Tue Sep 24 2024 11:16:26 by 
          <a href="http://www.doxygen.org/index.html">
            Doxygen
          </a> 
        1.12.0
      </li>
    </ul>
  </div>
  <!--Main Content-->
  <div class="hidden">
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__drivers__ltc4150.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">LTC4150 coulomb counter<div class="ingroups"><a class="el" href="group__drivers.html">Drivers</a> &raquo; <a class="el" href="group__drivers__sensors.html">Sensor Device Drivers</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Driver for the Linear Tech LTC4150 Coulomb Counter (a.k.a.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Driver for the Linear Tech LTC4150 Coulomb Counter (a.k.a. </p>
<p>battery gauge sensor or power consumption sensor)</p>
<h1><a class="anchor" id="autotoc_md1667"></a>
Wiring the LTC4150</h1>
<p>Hint: M Grusin thankfully created an <a href="https://cdn.sparkfun.com/datasheets/BreakoutBoards/LTC4150_BOB_v10.pdf">open hardware breakout board</a>. As a result, virtually all LTC4150 breakout boards are using this schematic. Whenever this documentation refers to a breakout board, this open hardware board is meant. Of course, this driver works with the "bare" LTC4150 as well.</p>
<p>Please note that this driver works interrupt driven and does not clear the signal. Thus, the /CLR and /INT pins on the LTC4150 need to be connected (in case of the breakout board: close solder jumper SJ1), so that the signal is automatically cleared.</p>
<p>Hint: The breakout board uses external pull up resistors on /INT, POL and /SHDN. Therefore /SHDN can be left unconnected and no internal pull ups are required for /INT and POL. In case your board uses 3.3V logic the solder jumpers SJ2 and SJ3 have to be closed, in case of 5V they have to remain open. Connect the VIO pin to the logic level, GND to ground, IN+ and IN- to the power supply and use OUT+ and OUT- to power your board.</p>
<p>In the easiest case only the /INT pin needs to be connected to a GPIO, and (in case of external pull ups) /SHDN and POL can be left unconnected. The GPIO /INT is connected to support for interrupts, /SHDN and POL (if connected) do not require interrupt support.</p>
<p>In case a battery is used the POL pin connected to another GPIO. This allows to distinguish between charge drawn from the battery and charge transferred into the battery (used to load it).</p>
<p>In case support to power off the LTC4150 is desired, the /SHDN pin needs to be connected to a third GPIO.</p>
<h1><a class="anchor" id="autotoc_md1668"></a>
Things to keep in mind</h1>
<p>The LTC4150 creates pulses with a frequency depending on the current drawn. Thus, more interrupts need to be handled when more current is drawn, which in turn increases system load (and power consumption). The interrupt service routing is quite short and even when used outside of specification less than 20 ticks per second will occur. Hence, this effect should hopefully be negligible. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ltc4150_8h.html">ltc4150.h</a></td></tr>
<tr class="memdesc:ltc4150_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">LTC4150 coulomb counter. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ltc4150__params_8h.html">ltc4150_params.h</a></td></tr>
<tr class="memdesc:ltc4150__params_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default configuration for LTC4150 coulomb counters. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__recorder__t.html">ltc4150_recorder_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to allow recording of the drawn current in a user defined resolution.  <a href="structltc4150__recorder__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__params__t.html">ltc4150_params_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters required to set up the LTC4150 coulomb counter.  <a href="structltc4150__params__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__dev.html">ltc4150_dev</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">LTC4150 coulomb counter.  <a href="structltc4150__dev.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__last__minute__data__t.html">ltc4150_last_minute_data_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure used by <a class="el" href="#ga2a4b5144157383f5a4ab76251130ec29">ltc4150_last_minute</a>.  <a href="structltc4150__last__minute__data__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gacea050c124a43ee9deeb487b231381b6" id="r_gacea050c124a43ee9deeb487b231381b6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structltc4150__dev.html">ltc4150_dev</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a></td></tr>
<tr class="memdesc:gacea050c124a43ee9deeb487b231381b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">LTC4150 coulomb counter.  <br /></td></tr>
<tr class="separator:gacea050c124a43ee9deeb487b231381b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga4eeeead548222804e141df8f1b205ca8" id="r_ga4eeeead548222804e141df8f1b205ca8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="#gga4eeeead548222804e141df8f1b205ca8ac5c149c6fcf7ca08031e4c94d1da9c30">LTC4150_INT_EXT_PULL_UP</a> = 0x01
, <a class="el" href="#gga4eeeead548222804e141df8f1b205ca8a3894eb1352bfe95e8d7df8a0dc6a2c35">LTC4150_POL_EXT_PULL_UP</a> = 0x02
, <a class="el" href="#gga4eeeead548222804e141df8f1b205ca8a2cca2783809788c4b5254012d78a5e80">LTC4150_EXT_PULL_UP</a> = LTC4150_INT_EXT_PULL_UP | LTC4150_POL_EXT_PULL_UP
 }</td></tr>
<tr class="memdesc:ga4eeeead548222804e141df8f1b205ca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration flags of the LTC4150 coulomb counter.  <a href="#ga4eeeead548222804e141df8f1b205ca8">More...</a><br /></td></tr>
<tr class="separator:ga4eeeead548222804e141df8f1b205ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8838cbe7f55e7f6946f74c100a10a8af" id="r_ga8838cbe7f55e7f6946f74c100a10a8af"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8838cbe7f55e7f6946f74c100a10a8af">ltc4150_dir_t</a> { <a class="el" href="#gga8838cbe7f55e7f6946f74c100a10a8afa1ec59ceb1167d2f42dc0c0b0ec188b64">LTC4150_CHARGE</a>
, <a class="el" href="#gga8838cbe7f55e7f6946f74c100a10a8afa6bd7dd6cf179c3075989e7f6bf0e6078">LTC4150_DISCHARGE</a>
 }</td></tr>
<tr class="memdesc:ga8838cbe7f55e7f6946f74c100a10a8af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration of directions in which the charge can be transferred.  <a href="#ga8838cbe7f55e7f6946f74c100a10a8af">More...</a><br /></td></tr>
<tr class="separator:ga8838cbe7f55e7f6946f74c100a10a8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4fa850f74cbacdf35d41a0a111265d49" id="r_ga4fa850f74cbacdf35d41a0a111265d49"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4fa850f74cbacdf35d41a0a111265d49">ltc4150_init</a> (<a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, const <a class="el" href="structltc4150__params__t.html">ltc4150_params_t</a> *params)</td></tr>
<tr class="memdesc:ga4fa850f74cbacdf35d41a0a111265d49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the LTC4150 driver.  <br /></td></tr>
<tr class="separator:ga4fa850f74cbacdf35d41a0a111265d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1840c34b0f4bd05ffa9279b934189848" id="r_ga1840c34b0f4bd05ffa9279b934189848"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1840c34b0f4bd05ffa9279b934189848">ltc4150_reset_counters</a> (<a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev)</td></tr>
<tr class="memdesc:ga1840c34b0f4bd05ffa9279b934189848"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear current counters of the given LTC4150 device.  <br /></td></tr>
<tr class="separator:ga1840c34b0f4bd05ffa9279b934189848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2de1ec4e0b025996428b85484b45b683" id="r_ga2de1ec4e0b025996428b85484b45b683"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2de1ec4e0b025996428b85484b45b683">ltc4150_shutdown</a> (<a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev)</td></tr>
<tr class="memdesc:ga2de1ec4e0b025996428b85484b45b683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable the interrupt handler and turn the chip off.  <br /></td></tr>
<tr class="separator:ga2de1ec4e0b025996428b85484b45b683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54b4a64e07c4fd49480c7220aaebb311" id="r_ga54b4a64e07c4fd49480c7220aaebb311"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga54b4a64e07c4fd49480c7220aaebb311">ltc4150_charge</a> (<a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, uint32_t *charged, uint32_t *discharged)</td></tr>
<tr class="memdesc:ga54b4a64e07c4fd49480c7220aaebb311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the measured charge since boot or last reset in millicoulomb.  <br /></td></tr>
<tr class="separator:ga54b4a64e07c4fd49480c7220aaebb311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7cf0e00f44778e6c55ee87cbeed87998" id="r_ga7cf0e00f44778e6c55ee87cbeed87998"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7cf0e00f44778e6c55ee87cbeed87998">ltc4150_avg_current</a> (<a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, int16_t *dest)</td></tr>
<tr class="memdesc:ga7cf0e00f44778e6c55ee87cbeed87998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the average current drawn in E-01 milliampere.  <br /></td></tr>
<tr class="separator:ga7cf0e00f44778e6c55ee87cbeed87998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ad8761da01fd64c8571aa49d58b5264" id="r_ga3ad8761da01fd64c8571aa49d58b5264"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3ad8761da01fd64c8571aa49d58b5264">ltc4150_last_minute_charge</a> (<a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, <a class="el" href="structltc4150__last__minute__data__t.html">ltc4150_last_minute_data_t</a> *data, uint32_t *charged, uint32_t *discharged)</td></tr>
<tr class="memdesc:ga3ad8761da01fd64c8571aa49d58b5264"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the measured charge in the last minute.  <br /></td></tr>
<tr class="separator:ga3ad8761da01fd64c8571aa49d58b5264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabacb8f10da53a90b9626d036e031d47c" id="r_gabacb8f10da53a90b9626d036e031d47c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabacb8f10da53a90b9626d036e031d47c">ltc4150_pulses2c</a> (const <a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, uint32_t *charged, uint32_t *discharged, uint32_t raw_charged, uint32_t raw_discharged)</td></tr>
<tr class="memdesc:gabacb8f10da53a90b9626d036e031d47c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the raw data (# pulses) acquired by the LTC4150 device to charge information in millicoulomb.  <br /></td></tr>
<tr class="separator:gabacb8f10da53a90b9626d036e031d47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga2a4b5144157383f5a4ab76251130ec29" id="r_ga2a4b5144157383f5a4ab76251130ec29"><td class="memItemLeft" align="right" valign="top"><a id="ga2a4b5144157383f5a4ab76251130ec29" name="ga2a4b5144157383f5a4ab76251130ec29"></a>
const <a class="el" href="structltc4150__recorder__t.html">ltc4150_recorder_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>ltc4150_last_minute</b></td></tr>
<tr class="memdesc:ga2a4b5144157383f5a4ab76251130ec29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records the charge transferred within the last minute using. <br /></td></tr>
<tr class="separator:ga2a4b5144157383f5a4ab76251130ec29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gacea050c124a43ee9deeb487b231381b6" name="gacea050c124a43ee9deeb487b231381b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacea050c124a43ee9deeb487b231381b6">&#9670;&#160;</a></span>ltc4150_dev_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structltc4150__dev.html">ltc4150_dev</a> <a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>LTC4150 coulomb counter. </p>

<p class="definition">Definition at line <a class="el" href="ltc4150_8h_source.html#l00103">103</a> of file <a class="el" href="ltc4150_8h_source.html">ltc4150.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga4eeeead548222804e141df8f1b205ca8" name="ga4eeeead548222804e141df8f1b205ca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4eeeead548222804e141df8f1b205ca8">&#9670;&#160;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configuration flags of the LTC4150 coulomb counter. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga4eeeead548222804e141df8f1b205ca8ac5c149c6fcf7ca08031e4c94d1da9c30" name="gga4eeeead548222804e141df8f1b205ca8ac5c149c6fcf7ca08031e4c94d1da9c30"></a>LTC4150_INT_EXT_PULL_UP&#160;</td><td class="fielddoc"><p>External pull on the /INT pin is present. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4eeeead548222804e141df8f1b205ca8a3894eb1352bfe95e8d7df8a0dc6a2c35" name="gga4eeeead548222804e141df8f1b205ca8a3894eb1352bfe95e8d7df8a0dc6a2c35"></a>LTC4150_POL_EXT_PULL_UP&#160;</td><td class="fielddoc"><p>External pull on the /POL pin is present. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4eeeead548222804e141df8f1b205ca8a2cca2783809788c4b5254012d78a5e80" name="gga4eeeead548222804e141df8f1b205ca8a2cca2783809788c4b5254012d78a5e80"></a>LTC4150_EXT_PULL_UP&#160;</td><td class="fielddoc"><p>External pull on the /INT <em>and</em> the /POL pin is present. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ltc4150_8h_source.html#l00077">77</a> of file <a class="el" href="ltc4150_8h_source.html">ltc4150.h</a>.</p>

</div>
</div>
<a id="ga8838cbe7f55e7f6946f74c100a10a8af" name="ga8838cbe7f55e7f6946f74c100a10a8af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8838cbe7f55e7f6946f74c100a10a8af">&#9670;&#160;</a></span>ltc4150_dir_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ga8838cbe7f55e7f6946f74c100a10a8af">ltc4150_dir_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration of directions in which the charge can be transferred. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga8838cbe7f55e7f6946f74c100a10a8afa1ec59ceb1167d2f42dc0c0b0ec188b64" name="gga8838cbe7f55e7f6946f74c100a10a8afa1ec59ceb1167d2f42dc0c0b0ec188b64"></a>LTC4150_CHARGE&#160;</td><td class="fielddoc"><p>The battery is charged. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8838cbe7f55e7f6946f74c100a10a8afa6bd7dd6cf179c3075989e7f6bf0e6078" name="gga8838cbe7f55e7f6946f74c100a10a8afa6bd7dd6cf179c3075989e7f6bf0e6078"></a>LTC4150_DISCHARGE&#160;</td><td class="fielddoc"><p>Charge is drawn from the battery. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ltc4150_8h_source.html#l00095">95</a> of file <a class="el" href="ltc4150_8h_source.html">ltc4150.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga7cf0e00f44778e6c55ee87cbeed87998" name="ga7cf0e00f44778e6c55ee87cbeed87998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7cf0e00f44778e6c55ee87cbeed87998">&#9670;&#160;</a></span>ltc4150_avg_current()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_avg_current </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *</td>          <td class="paramname"><span class="paramname"><em>dest</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the average current drawn in E-01 milliampere. </p>
<p>This will return the average current drawn since boot or last reset until the last pulse from the LTC4150 was received. The value might thus be a bit outdated (0.8 seconds for the breakout board and a current of 100mA, 79 seconds for a current of 1mA).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>The LTC4150 device to read data from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dest</td><td>Store the average current drawn in E-01 milliampere here</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument </td></tr>
    <tr><td class="paramname">-EAGAIN</td><td>Called before enough data samples have been acquired. (Wait for at least one second or one pulse from the LTC4150, whichever takes longer.) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga54b4a64e07c4fd49480c7220aaebb311" name="ga54b4a64e07c4fd49480c7220aaebb311"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54b4a64e07c4fd49480c7220aaebb311">&#9670;&#160;</a></span>ltc4150_charge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_charge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>charged</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>discharged</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the measured charge since boot or last reset in millicoulomb. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>The LTC4150 device to read data from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charged</td><td>The charge transferred in charging direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">discharged</td><td>The charge transferred in discharging direction</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument</td></tr>
  </table>
  </dd>
</dl>
<p>Passing <code>NULL</code> for <code>charged</code> or <code>discharged</code> is allowed, if only one information is of interest. </p>

</div>
</div>
<a id="ga4fa850f74cbacdf35d41a0a111265d49" name="ga4fa850f74cbacdf35d41a0a111265d49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fa850f74cbacdf35d41a0a111265d49">&#9670;&#160;</a></span>ltc4150_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structltc4150__params__t.html">ltc4150_params_t</a> *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the LTC4150 driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Device to initialize </td></tr>
    <tr><td class="paramname">params</td><td>Information on how the LTC4150 is conntected</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with invalid argument(s) </td></tr>
    <tr><td class="paramname">-EIO</td><td>IO failure (<code><a class="el" href="group__drivers__periph__gpio.html#gab7d8ecaeb639070a28027a8fd31a0955" title="Initialize the given pin as general purpose input or output.">gpio_init()</a></code>/<code><a class="el" href="group__drivers__periph__gpio.html#ga48ba4c318486db320a4bf6237b49d61c" title="Initialize a GPIO pin for external interrupt usage.">gpio_init_int()</a></code> failed) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga3ad8761da01fd64c8571aa49d58b5264" name="ga3ad8761da01fd64c8571aa49d58b5264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ad8761da01fd64c8571aa49d58b5264">&#9670;&#160;</a></span>ltc4150_last_minute_charge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_last_minute_charge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structltc4150__last__minute__data__t.html">ltc4150_last_minute_data_t</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>charged</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>discharged</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the measured charge in the last minute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>The LTC4150 device to read data from </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data</td><td>The data recorded by <a class="el" href="#ga2a4b5144157383f5a4ab76251130ec29">ltc4150_last_minute</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charged</td><td>The charge transferred in charging direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">discharged</td><td>The charge transferred in discharging direction</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The returned data may be outdated up to ten seconds</dd></dl>
<p>Passing <code>NULL</code> for <code>charged</code> or <code>discharged</code> is allowed, if only one information is of interest. </p>

</div>
</div>
<a id="gabacb8f10da53a90b9626d036e031d47c" name="gabacb8f10da53a90b9626d036e031d47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabacb8f10da53a90b9626d036e031d47c">&#9670;&#160;</a></span>ltc4150_pulses2c()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ltc4150_pulses2c </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>charged</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>discharged</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>raw_charged</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>raw_discharged</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert the raw data (# pulses) acquired by the LTC4150 device to charge information in millicoulomb. </p>
<dl class="section note"><dt>Note</dt><dd>This function will make writing data recorders (see <a class="el" href="structltc4150__recorder__t.html">ltc4150_recorder_t</a>) easier, but is not intended for end users</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>LTC4150 device the data was received from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charged</td><td>Charge in charging direction is stored here </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">discharged</td><td>Charge in discharging direction is stored here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw_charged</td><td>Number of pulses in charging direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw_discharged</td><td>Number of pulses in discharging direction </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1840c34b0f4bd05ffa9279b934189848" name="ga1840c34b0f4bd05ffa9279b934189848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1840c34b0f4bd05ffa9279b934189848">&#9670;&#160;</a></span>ltc4150_reset_counters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_reset_counters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear current counters of the given LTC4150 device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>The LTC4150 device to clear current counters from</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2de1ec4e0b025996428b85484b45b683" name="ga2de1ec4e0b025996428b85484b45b683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2de1ec4e0b025996428b85484b45b683">&#9670;&#160;</a></span>ltc4150_shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *</td>          <td class="paramname"><span class="paramname"><em>dev</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable the interrupt handler and turn the chip off. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Previously initialized device to power off</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with invalid argument(s)</td></tr>
  </table>
  </dd>
</dl>
<p>The driver can be reinitialized to power on the LTC4150 chip again </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->

    </div>
  </body>
</html>
