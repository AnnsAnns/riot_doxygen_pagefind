<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RIOT OS: Porting boards</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<!-- <script type="text/javascript" src="jquery.js"></script> -->
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<!-- <link href="/pagefind/pagefind-ui.css" rel="stylesheet"> -->
<script src="/pagefind/pagefind-ui.js"></script>
<script>
  // Check whether the PagefindUI class is available
  if (typeof PagefindUI === 'undefined') {
    console.error('PagefindUI class is not available | Dev Build');
  } else {
    // // Remove the "searchstub" element and initialize the PagefindUI class
    // document.getElementById("#searchstub").remove();
    // Initialize the PagefindUI class with the element id "search"
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
  }
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="global.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <script>
    // Print the data within the NAVTREE variable from the navtreedata.js file
    var navtree = NAVTREE;
    console.log(navtree);
  </script>
<div class="flex flex-row gap-4 w-screen font-sans text-lg max-h-screen overscroll-contain justify-items-stretch bg-neutral-900">
  <!--Sidebar-->
  <div data-pagefind-ignore="all" class="w-1/3 max-w-md flex-auto h-screen bg-neutral-800 ring-2 ring-neutral-700 shadow-neutral-800 shadow-2xl rounded-xl p-3 ml-1 my-2 mr-3 flex flex-col justify-around">
    <div id="top" class="justify-self-center content-center items-center place-content-center">
      <img alt="Logo" src="riot-logo.svg"/>
      <div id="projectbrief">
        The friendly Operating System for the Internet of Things
      </div>
    </div>
    <div id="search" class="place-content-center" class="overflow-y-scroll max-h-64 bg-slate-400 ring-2 ring-white text-white" >
      <h1>Searchbar via Pagefind</h1>
      <!-- <div id="searchstub" class="flex items-center border border-gray-300 rounded-lg p-2 shadow-sm">
        <input type="text" placeholder="Search is only available in Production Build ..." class="flex-grow p-2 outline-none">
      </div> -->
    </div>
    <div id="navtree">
      <script>
        // The navtree variable is always a pair of two elements (key, value)
        // The key is the name we should display and the value is the link to the page
        // Generate the navtree from the navtreedata.js file and put it under the navtree div
        var navtree = NAVTREE[0][2];
        var navtreeHTML = "<h1>Navigation based on Doxygen</h1> <ul>";
        for (var i = 0; i < navtree.length; i++) {
          navtreeHTML += "<li><a href='" + navtree[i][1] + "'>" + navtree[i][0] + "</a></li>";
          if (i == 5) {
            navtreeHTML += '<li><h3 class="ring-2 ring-white"> Random Insert for Demonstration </h3></li>';
          }
        }
        navtreeHTML += "</ul>";
        document.getElementById("navtree").innerHTML = navtreeHTML;
      </script>
    </div>
    <ul>
      <li class="footer">
        Generated on Tue Sep 24 2024 11:16:26 by 
          <a href="http://www.doxygen.org/index.html">
            Doxygen
          </a> 
        1.12.0
      </li>
    </ul>
  </div>
  <!--Main Content-->
  <div class="hidden">
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('porting-boards.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Porting boards</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doc_2doxygen_2src_2porting-boards"></a></p>
<p>At some point you might need to port a new <code>BOARD</code> to <code>RIOT</code>, either because that specific development board is not yet supported or because you have a custom <code>BOARD</code> for your project.</p>
<p>If you want to port a <code>BOARD</code> to <code>RIOT</code> you have two choices: doing it inside of <code>RIOTBASE</code> or outside. In either case the file structure is basically the same and moving from one to another is easy.</p>
<p>This guide details the generic structure you need to add a new <code>BOARD</code> to <code>RIOT</code>, the different files as well as their functionality.</p>
<dl class="section note"><dt>Note</dt><dd>We assume here that your <code>CPU</code> and <code>CPU_MODEL</code> is already supported in <code>RIOT</code> so no peripheral or cpu implementation is needed.</dd></dl>
<h1><a class="anchor" id="porting-flowchart"></a>
Porting flowchart</h1>
<div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_porting-boards.svg" width="847" height="910"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<h1><a class="anchor" id="general-structure"></a>
General structure</h1>
<p>Like <a class="el" href="creating-an-application.html">applications</a> or <a class="el" href="creating-modules.html">modules</a>, boards consist on a directory containing source files and makefiles. Usually a <code>BOARD</code> directory has the following structure</p>
<div class="fragment"><div class="line">board-foo/</div>
<div class="line">|----dist/</div>
<div class="line">    |----scripts</div>
<div class="line">|----board.c</div>
<div class="line">|----doc.txt</div>
<div class="line">|----include/</div>
<div class="line">    |----periph_conf.h</div>
<div class="line">    |----board.h</div>
<div class="line">    |----gpio_params.h</div>
<div class="line">|----Makefile</div>
<div class="line">|----Makefile.dep</div>
<div class="line">|----Makefile.features</div>
<div class="line">|----Makefile.include</div>
</div><!-- fragment --><h2><a class="anchor" id="board-source-files"></a>
Source files</h2>
<p>Header files in <code>board-foo/include</code> define physical mappings or configurations. e.g:</p>
<ul>
<li><code>periph_conf.h</code>: defines configurations and mappings for peripherals as well as clock configurations.</li>
<li><code>board.h</code>: holds board specific definitions or mappings, for example LEDs, buttons. It might as well override default drivers parameters (e.g.: assigning specific pin connections to a LCD screen, radio, etc.). Some boards might also define optimized <code>XTIMER_%</code> values (e.g. <a class="el" href="cpu_2native_2include_2periph__conf_8h.html#a370b9e9a079c4cb4f54fd947b67b9f41">XTIMER_BACKOFF</a>).</li>
<li><code>gpio_params.h</code>: if the board supports <a class="el" href="group__drivers__saul.html">SAUL</a> then its <a class="el" href="structsaul__gpio__params__t.html">saul_gpio_params_t</a> is defined here. (Analogously, a <code>adc_params.h</code> can contain a <a class="el" href="structsaul__adc__params__t.html">saul_adc_params_t</a>, and <code>pwm_params.h</code> a <a class="el" href="structsaul__pwm__rgb__params__t.html">saul_pwm_rgb_params_t</a> and a <a class="el" href="structsaul__pwm__dimmer__params__t.html">saul_pwm_dimmer_params_t</a>).</li>
<li>other: other specific headers needed by one <code>BOARD</code></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Header files do not need to be defined in <code>include/</code>, but if defined somewhere else then they must be added to the include path. In <code>Makefile.include</code>: <code>INCLUDES += -I&lt;some&gt;/&lt;directory&gt;/&lt;path&gt;</code></dd></dl>
<p>Board initialization functions are defined in <code>board.c</code>. This file can define a <code><a class="el" href="group__core__init__config.html#ga916f2adc2080b4fe88034086d107a8dc" title="Initialize board specific hardware.">board_init()</a></code> function that is called at startup. It is run before the scheduler is started, so it must not block (e.g. by performing I2C operations).</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group__core__init__config.html#ga916f2adc2080b4fe88034086d107a8dc">board_init</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* initialize GPIO or others... */</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="agroup__core__init__config_html_ga916f2adc2080b4fe88034086d107a8dc"><div class="ttname"><a href="group__core__init__config.html#ga916f2adc2080b4fe88034086d107a8dc">board_init</a></div><div class="ttdeci">void board_init(void)</div><div class="ttdoc">Initialize board specific hardware.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md2212"></a>
Makefiles</h2>
<h3><a class="anchor" id="Makefile"></a>
Makefile</h3>
<p>A board's Makefile just needs to include <code>Makefile.base</code> in the RIOT repository and define the <code>MODULE</code> as <code>board</code> (see <a class="el" href="creating-modules.html">modules</a> for more details)</p>
<div class="fragment"><div class="line">MODULE = board</div>
<div class="line"> </div>
<div class="line">include $(RIOTBASE)/Makefile.base</div>
</div><!-- fragment --><h3><a class="anchor" id="makefile-dep"></a>
Makefile.dep</h3>
<p>Dependencies on other <code>MODULES</code> or <code>FEATURES</code> can be defined here. This might specify <code>MODULES</code> or dependencies that need to be pulled under specific configurations. e.g.: if your board has a sx1276 lora chip:</p>
<div class="fragment"><div class="line">ifneq (,$(filter netdev_default,$(USEMODULE)))</div>
<div class="line">  USEMODULE += sx1276</div>
<div class="line">endif</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><code>Makefile.dep</code> is processed only once so you have to take care of adding the dependency block for your board <em>before</em> its dependencies pull in their own dependencies.</dd></dl>
<h4><a class="anchor" id="autotoc_md2213"></a>
Default configurations</h4>
<p>As explained in <a class="el" href="getting-started.html#default-configurations">Default Configurations</a>, there are two pseudomodules that are used to indicate that certain drivers of devices present in the platform should be enabled. Each board (or CPU) has knowledge as to which drivers should be enabled in each case.</p>
<p>The previous code snippet shows how a board which has a <a class="el" href="group__drivers__sx127x.html">Semtech SX1272 and SX1276 radios driver</a> device, pulls in its driver when the default network interfaces are required.</p>
<p>When the pseudomodule <code>saul_default</code> is enabled, the board should pull in all the drivers of the devices it has which provide a <a class="el" href="group__drivers__saul.html">[S]ensor [A]ctuator [U]ber [L]ayer</a> interface. This is usually done as following:</p>
<div class="fragment"><div class="line">ifneq (,$(filter saul_default,$(USEMODULE)))</div>
<div class="line">  USEMODULE += saul_gpio</div>
<div class="line">  USEMODULE += apds9960</div>
<div class="line">  USEMODULE += bmp280_i2c</div>
<div class="line">  USEMODULE += lis3mdl</div>
<div class="line">  USEMODULE += sht3x</div>
<div class="line">endif</div>
</div><!-- fragment --><h3><a class="anchor" id="makefile-features"></a>
Makefile.features</h3>
<p>This file defines all the features provided by the BOARD. These features might also need to be supported by the <code>CPU</code>. Here, define the <code>CPU</code> and <code>CPU_MODEL</code> (see build system basics for more details on these variables).</p>
<p>e.g.:</p>
<div class="fragment"><div class="line">CPU = foo</div>
<div class="line">CPU_MODEL = foobar</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Put defined MCU peripherals here (in alphabetical order)</span></div>
<div class="line">FEATURES_PROVIDED += periph_i2c</div>
<div class="line">FEATURES_PROVIDED += periph_spi</div>
<div class="line">FEATURES_PROVIDED += periph_uart</div>
</div><!-- fragment --><h3><a class="anchor" id="makefile-include"></a>
Makefile.include</h3>
<p>This file contains BSP or toolchain configurations for the <code>BOARD</code>. It should at least define the configuration needed for flashing (i.e. specify a default programmer) as well as the serial configuration (if one is available). The default serial port configuration is provided by <code>makefiles/tools/serial.inc.mk</code> and define the following values for the serial port (depends on the host OS):</p>
<div class="fragment"><div class="line">PORT_LINUX ?= /dev/ttyACM0</div>
<div class="line">PORT_DARWIN ?= $(firstword $(sort $(wildcard /dev/tty.usbmodem*)))</div>
</div><!-- fragment --><p>So if the board is also using this, there's no need to redefine these variables in the board configuration.</p>
<p>For example a board that is using a custom serial port (via an USB to serial adapter) and that is flashed using openocd by default would have the following content in its <code>Makefile.include</code>:</p>
<div class="fragment"><div class="line"><span class="comment"># Define the default port depending on the host OS</span></div>
<div class="line">PORT_LINUX ?= /dev/ttyUSB0</div>
<div class="line">PORT_DARWIN ?= $(firstword $(sort $(wildcard /dev/tty.usbserial*)))</div>
<div class="line"> </div>
<div class="line"><span class="comment"># this board uses openocd</span></div>
<div class="line">PROGRAMMER ?= openocd</div>
</div><!-- fragment --><h2><a class="anchor" id="board-timer-configurations"></a>
Timer Configurations</h2>
<p>When using high level timers, i.e. <code>ztimer</code> there is an overhead in calling for <a class="el" href="group__sys__ztimer.html#gade98636e198f2d571c8acd861d29d360">ztimer_sleep</a> and <a class="el" href="group__sys__ztimer.html#ga8934a79a89e35d58673418a1e4a2e69c">ztimer_set</a> functions. This offset can be compensated for. It can be measured by running <code>tests/sys/ztimer_overhead</code> on your board, i.e:</p>
<div class="fragment"><div class="line">$ BOARD=my-new-board make -C tests/sys/ztimer_overhead</div>
<div class="line">main(): This is RIOT!</div>
<div class="line">ZTIMER_USEC auto_adjust params:</div>
<div class="line">    ZTIMER_USEC-&gt;adjust_set = xx</div>
<div class="line">    ZTIMER_USEC-&gt;adjust_sleep = xx</div>
<div class="line">ZTIMER_USEC auto_adjust params cleared</div>
<div class="line">zitmer_overhead_set...</div>
<div class="line">min=6 max=7 avg_diff=6</div>
<div class="line">zitmer_overhead_sleep...</div>
<div class="line">min=21 max=21 avg_diff=21</div>
<div class="line">ZTIMER_USEC adjust params for my-new-board:</div>
<div class="line">    CONFIG_ZTIMER_USEC_ADJUST_SET    6</div>
<div class="line">    CONFIG_ZTIMER_USEC_ADJUST_SLEEP  21</div>
</div><!-- fragment --><p>The last two lines can be added as defines to the new board <code>board.h</code>:</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#define CONFIG_ZTIMER_USEC_ADJUST_SET     6</span></div>
<div class="line"><span class="preprocessor">#define CONFIG_ZTIMER_USEC_ADJUST_SLEEP   21</span></div>
<div class="line"> </div>
</div><!-- fragment --><h2><a class="anchor" id="board-doc"></a>
doc.txt</h2>
<p>Although not explicitly needed, if upstreamed and as a general good practice, this file holds all <code>BOARD</code> documentation. This can include datasheet reference, documentation on how to flash, etc.</p>
<p>The documentation must be under the proper doxygen group, you can compile the documentation by calling <code>make doc</code> and then open the generated html file on any browser.</p>
<div class="fragment"><div class="line">/**</div>
<div class="line">@defgroup    boards_foo FooBoard</div>
<div class="line">@ingroup     boards</div>
<div class="line">@brief       Support for the foo board</div>
<div class="line">@author      FooName BarName &lt;foo.bar@baz.com&gt;</div>
<div class="line"> </div>
<div class="line">### User Interface</div>
<div class="line"> </div>
<div class="line">  ....</div>
<div class="line"> </div>
<div class="line">### Using UART</div>
<div class="line"> </div>
<div class="line">  ...</div>
<div class="line"> </div>
<div class="line">### Flashing the device</div>
<div class="line"> </div>
<div class="line">  ...</div>
<div class="line"> </div>
<div class="line">*/</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2214"></a>
Helper tools</h1>
<p>To help you start porting a board, the RIOT build system provides the <code>generate-board</code> make target. It is a wrapper around the <a href="https://pypi.org/project/riotgen/">riotgen</a> command line tool that is helpful when starting to port a board: all required files are generated with copyright headers, doxygen groups, etc, so you can concentrate on the port. The board source files are created in the <code>boards/&lt;board name&gt;</code> directory.</p>
<p><b>Usage:</b></p>
<p>From the RIOT base directory, run: </p><div class="fragment"><div class="line">make generate-board</div>
</div><!-- fragment --><p> Then answer a few questions about the driver:</p><ul>
<li>Board name: Enter a name for your board. It will be used as the name of the board directory under <code>boards</code>.</li>
<li>Board displayed name: Enter the name of the board, as displayed in the Doxygen documentation.</li>
<li>CPU name: Enter the name of the CPU embedded on the board.</li>
<li>CPU model name: Enter the precise model name of the CPU.</li>
<li>Features provided: CPU features provided (and configured) for this board.</li>
</ul>
<p>Other global information (author name, email, organization) should be retrieved automatically from your git configuration.</p>
<h1><a class="anchor" id="common-board-code"></a>
Using Common code</h1>
<p>To avoid code duplication, common code across boards has been grouped in <code>boards/common</code>. e.g. <code>BOARD</code>s based on the same cpu (<code>boards/common/nrf52</code>) or <code>BOARD</code>s having the same layout <code>boards/common/nucleo64</code>.</p>
<p>In the case of source files this means some functions like <code>board_init</code> can be already defined in the common code. Unless having specific configurations or initialization you might not need a <code>board.c</code> or <code>board.h</code>. Another common use case is common peripheral configurations, for example in the <code><a class="el" href="cfg__timer__tim5_8h.html" title="Common configuration for STM32 Timer peripheral based on TIM5.">cfg_timer_tim5.h</a></code>:</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structtimer__conf__t.html">timer_conf_t</a> timer_config[] = {</div>
<div class="line">    {</div>
<div class="line">        .dev      = TIM5,</div>
<div class="line">        .max      = 0xffffffff,</div>
<div class="line">        .rcc_mask = RCC_APB1ENR_TIM5EN,</div>
<div class="line">        .bus      = <a class="code hl_enumvalue" href="gd32v_2include_2periph__cpu_8h.html#afcbe9c50af707480e7b3e6e9058cedc8a0a7928dc21633f8cf78bf136bda6fe45">APB1</a>,</div>
<div class="line">        .irqn     = TIM5_IRQn</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define TIMER_0_ISR         isr_tim5</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define TIMER_NUMOF         ARRAY_SIZE(timer_config)</span></div>
<div class="line"> </div>
<div class="ttc" id="agd32v_2include_2periph__cpu_8h_html_afcbe9c50af707480e7b3e6e9058cedc8a0a7928dc21633f8cf78bf136bda6fe45"><div class="ttname"><a href="gd32v_2include_2periph__cpu_8h.html#afcbe9c50af707480e7b3e6e9058cedc8a0a7928dc21633f8cf78bf136bda6fe45">APB1</a></div><div class="ttdeci">@ APB1</div><div class="ttdoc">Advanced Peripheral Bus 1</div><div class="ttdef"><b>Definition</b> <a href="gd32v_2include_2periph__cpu_8h_source.html#l00079">periph_cpu.h:79</a></div></div>
<div class="ttc" id="astructtimer__conf__t_html"><div class="ttname"><a href="structtimer__conf__t.html">timer_conf_t</a></div><div class="ttdoc">Timer device configuration.</div><div class="ttdef"><b>Definition</b> <a href="atxmega_2include_2periph__cpu_8h_source.html#l00264">periph_cpu.h:264</a></div></div>
</div><!-- fragment --><p>If you want to use common makefiles, include them at the end of the specific <code>Makefile</code>, e.g. for a <code>Makefile.features</code>:</p>
<div class="fragment"><div class="line">CPU = foo</div>
<div class="line">CPU_MODEL = foobar</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Put defined MCU peripherals here (in alphabetical order)</span></div>
<div class="line">FEATURES_PROVIDED += periph_i2c</div>
<div class="line">FEATURES_PROVIDED += periph_spi</div>
<div class="line">FEATURES_PROVIDED += periph_uart</div>
<div class="line"> </div>
<div class="line">include $(RIOTBOARD)/common/foo_common/Makefile.features</div>
</div><!-- fragment --><h1><a class="anchor" id="boards-outside-of-riotbase"></a>
Boards outside of RIOTBASE</h1>
<p>All <code>BOARD</code>s in RIOT reside in <code>RIOTBOARD</code> (<code>RIOTBOARD</code> being a make variable set to <code>$(RIOTBOARD)/boards</code>).</p>
<p>If one wants to use a <code>BOARD</code> outside of <code>RIOTBOARD</code>, the way to go is setting the <code>EXTERNAL_BOARD_DIRS</code> variable to the path to the directory containing your external boards, e.g.: <code>EXTERNAL_BOARD_DIRS=/home/external-boards/</code> (this would commonly be done in your application <code>Makefile</code> or your environment). You can specify multiple directories separated by spaces.</p>
<div class="fragment"><div class="line">/home/</div>
<div class="line">|----RIOT/</div>
<div class="line">    |---- ...</div>
<div class="line">|----external-boards/</div>
<div class="line">    |----board-foo/</div>
<div class="line">        |----dist/</div>
<div class="line">            |----scripts</div>
<div class="line">        |----board.c</div>
<div class="line">        |----doc.txt</div>
<div class="line">        |----include/</div>
<div class="line">            |----periph_conf.h</div>
<div class="line">            |----board.h</div>
<div class="line">            |----gpio_params.h</div>
<div class="line">        |----Makefile</div>
<div class="line">        |----Makefile.dep</div>
<div class="line">        |----Makefile.features</div>
<div class="line">        |----Makefile.include</div>
</div><!-- fragment --><p>If the external <code>BOARD</code> is very similar to a <code>BOARD</code> already present in <code>RIOTBOARD</code>, the external <code>BOARD</code> (<code>board-foo</code>) can inherit from that parent <code>BOARD</code> (e.g: <code>foo-parent</code>).</p>
<p>In this case some special considerations must be taken with the makefiles:</p>
<ul>
<li><code>Makefile</code><ul>
<li><code>MODULE</code> cannot be <code>board</code>: <code>foo-parent</code> will already define <code>MODULE = board</code>, so use any other name, lets say <code>MODULE = board-foo</code>.</li>
<li>Include the location of the parent <code>BOARD</code> to inherit from (if there is one):</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line">DIRS += $(RIOTBOARD)/foo-parent</div>
</div><!-- fragment --><ul>
<li><code>Makefile.include</code><ul>
<li>duplicate the include done by <code>$(RIOTBASE)/Makefile.include</code> to also include the parent board header. e.g: if inheriting from <code>foo-parent</code> `<code>INCLUDES += $(addprefix -I,$(wildcard $(RIOTBOARD)/foo-parent/include))</code></li>
</ul>
</li>
<li><code>Makefile.dep</code>: <code>board</code> is added by default to <code>USEMODULE</code> but since <code>board-foo</code> is used for this <code>BOARD</code>, it must be explicitly included by adding <code>USEMODULE += board-foo</code>.</li>
<li>Then simply include in each <code>Makefile.*</code> the corresponding parent <code>BOARD</code> <code>Makefile.*</code>, just as it is done for common <code>BOARD</code> code (as explained in <a class="el" href="#common-board-code">Using Common code</a>). e.g: <code>include $(RIOTBOARD)/foo-parent/Makefile.*include*</code></li>
</ul>
<p>An example can be found in <a href="https://github.com/RIOT-OS/RIOT/tree/master/tests/build_system/external_board_native"><code>tests/build_system/external_board_native</code></a></p>
<h1><a class="anchor" id="boards-tools"></a>
Tools</h1>
<p>Some scripts and tools available to ease <code>BOARD</code> porting and testing:</p>
<ul>
<li>Run <code>dist/tools/insufficient_memory/add_insufficient_memory_board.sh &lt;board&gt;</code> if your board has little memory. This updates the <code>Makefile.ci</code> lists to exclude the <code>BOARD</code> from automated compile-tests of applications that do not fit on the <code>BOARD</code>s <code>CPU</code>.</li>
<li>Run <code>dist/tools/compile_and_test_for_board/compile_and_test_for_board.py . &lt;board&gt; --with-test-only</code> to run all automated tests on the new board.</li>
</ul>
<h1><a class="anchor" id="further-reference"></a>
Further reference</h1>
<ul>
<li><a href="https://blog.martine-lenders.eu/riot-board-en.html">In her blog</a>, Martine Lenders documented her approach of porting the <a class="el" href="group__boards__feather-nrf52840.html">Adafruit Feather nRF52840 Express</a> in February 2020.</li>
<li><a href="https://hackmd.io/njFHwQ33SNS3sQKAkLkNtQ">Over at HackMD</a>, Akshai M documented his approach of porting the <a class="el" href="group__boards__slstk3400a.html">Silicon Labs SLSTK3400A starter kit</a> in July 2020. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

    </div>
  </body>
</html>
