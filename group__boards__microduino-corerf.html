<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RIOT OS: Microduino CoreRF</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<!-- <script type="text/javascript" src="jquery.js"></script> -->
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<!-- <link href="/pagefind/pagefind-ui.css" rel="stylesheet"> -->
<script src="/pagefind/pagefind-ui.js"></script>
<script>
  // Check whether the PagefindUI class is available
  if (typeof PagefindUI === 'undefined') {
    console.error('PagefindUI class is not available | Dev Build');
  } else {
    // // Remove the "searchstub" element and initialize the PagefindUI class
    // document.getElementById("#searchstub").remove();
    // Initialize the PagefindUI class with the element id "search"
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
  }
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="global.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <script>
    // Print the data within the NAVTREE variable from the navtreedata.js file
    var navtree = NAVTREE;
    console.log(navtree);
  </script>
<div class="flex flex-row gap-4 w-screen font-sans text-lg max-h-screen overscroll-contain justify-items-stretch bg-neutral-900">
  <!--Sidebar-->
  <div data-pagefind-ignore="all" class="w-1/3 max-w-md flex-auto h-screen bg-neutral-800 ring-2 ring-neutral-700 shadow-neutral-800 shadow-2xl rounded-xl p-3 ml-1 my-2 mr-3 flex flex-col justify-around">
    <div id="top" class="justify-self-center content-center items-center place-content-center">
      <img alt="Logo" src="riot-logo.svg"/>
      <div id="projectbrief">
        The friendly Operating System for the Internet of Things
      </div>
    </div>
    <div id="search" class="place-content-center" class="overflow-y-scroll max-h-64 bg-slate-400 ring-2 ring-white text-white" >
      <h1>Searchbar via Pagefind</h1>
      <!-- <div id="searchstub" class="flex items-center border border-gray-300 rounded-lg p-2 shadow-sm">
        <input type="text" placeholder="Search is only available in Production Build ..." class="flex-grow p-2 outline-none">
      </div> -->
    </div>
    <div id="navtree">
      <script>
        // The navtree variable is always a pair of two elements (key, value)
        // The key is the name we should display and the value is the link to the page
        // Generate the navtree from the navtreedata.js file and put it under the navtree div
        var navtree = NAVTREE[0][2];
        var navtreeHTML = "<h1>Navigation based on Doxygen</h1> <ul>";
        for (var i = 0; i < navtree.length; i++) {
          navtreeHTML += "<li><a href='" + navtree[i][1] + "'>" + navtree[i][0] + "</a></li>";
          if (i == 5) {
            navtreeHTML += '<li><h3 class="ring-2 ring-white"> Random Insert for Demonstration </h3></li>';
          }
        }
        navtreeHTML += "</ul>";
        document.getElementById("navtree").innerHTML = navtreeHTML;
      </script>
    </div>
    <ul>
      <li class="footer">
        Generated on Tue Sep 24 2024 11:16:27 by 
          <a href="http://www.doxygen.org/index.html">
            Doxygen
          </a> 
        1.12.0
      </li>
    </ul>
  </div>
  <!--Main Content-->
  <div class="hidden">
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__boards__microduino-corerf.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle"><div class="title">Microduino CoreRF<div class="ingroups"><a class="el" href="group__boards.html">Boards</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Support for the Microduino CoreRF board  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Support for the Microduino CoreRF board </p>
<h1><a class="anchor" id="autotoc_md538"></a>
Hardware</h1>
<h2><a class="anchor" id="autotoc_md539"></a>
Pinout</h2>
<p><img src="https://wiki.microduinoinc.com/images/d/df/RF%E5%BC%95%E8%84%9A.jpg" alt="corerf-pinout" class="inline"/></p>
<dl class="section warning"><dt>Warning</dt><dd>Unlike on other ATmega MCUs, the GPIOs are not 5V tolerant.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The 5V pin cannot be used to power the board, as the board is not equipped with an voltage regulator. The pin is therefore not connected. But it can be used to pass 5V to shields, if connected to a 5V supply voltage.</dd></dl>
<h2><a class="anchor" id="autotoc_md540"></a>
Board</h2>
<p>The board is just a breakout for the ATmega128RFA1 MCU.</p>
<h2><a class="anchor" id="autotoc_md541"></a>
MCU Details</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">MCU   </th><th class="markdownTableHeadLeft">ATmega128RFA1    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Family   </td><td class="markdownTableBodyLeft">ATmega    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Vendor   </td><td class="markdownTableBodyLeft">Atmel    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Package   </td><td class="markdownTableBodyLeft">QFN/MLF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SRAM   </td><td class="markdownTableBodyLeft">16KiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Flash   </td><td class="markdownTableBodyLeft">128KiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">EEPROM   </td><td class="markdownTableBodyLeft">4KiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Core Frequency   </td><td class="markdownTableBodyLeft">8MHz (16MHz no power save mode)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Oscillators   </td><td class="markdownTableBodyLeft">32.768 kHz &amp; 16 MHz    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="structTimer.html" title="struct to get time references within mqtt paho">Timer</a>   </td><td class="markdownTableBodyLeft">6 ( 2x8bit &amp; 4x16bit )    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Analog Comparator   </td><td class="markdownTableBodyLeft">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">ADCs   </td><td class="markdownTableBodyLeft">1x 15 channel 6 to 12-bit    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">USARTs   </td><td class="markdownTableBodyLeft">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SPIs   </td><td class="markdownTableBodyLeft">3 (1 SPI &amp; 2 USART SPI)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">I2Cs   </td><td class="markdownTableBodyLeft">1 (called TWI)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Vcc   </td><td class="markdownTableBodyLeft">1.8V - 3.6V    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Datasheet / Reference Manual   </td><td class="markdownTableBodyLeft"><a href="http://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-8266-MCU_Wireless-ATmega128RFA1_Datasheet.pdf">Datasheet and Reference Manual</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Board Manual   </td><td class="markdownTableBodyLeft"><a href="https://wiki.microduinoinc.com/Microduino-Module_CoreRF">Wiki Page</a>   </td></tr>
</table>
<p>The MCU comes with a 2.4 GHz IEEE 802.15.4 radio that is compatible with the Atmel AT86RF23x line of transceivers with the only difference being that it is not being accessed over an SPI bus, but instead the radio registers are directly mapped into memory.</p>
<h2><a class="anchor" id="autotoc_md542"></a>
Peripheral interfaces SPI and I2C</h2>
<p>According to the wiki, SPI and I2C pins are the following:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">SPI   </th><th class="markdownTableHeadLeft">Original Pin Name   </th><th class="markdownTableHeadLeft">Map Pin Name    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SS   </td><td class="markdownTableBodyLeft">PB4   </td><td class="markdownTableBodyLeft">D10    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">MOSI   </td><td class="markdownTableBodyLeft">PB2   </td><td class="markdownTableBodyLeft">D11    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">MISO   </td><td class="markdownTableBodyLeft">PB3   </td><td class="markdownTableBodyLeft">D12    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SCK   </td><td class="markdownTableBodyLeft">PB1   </td><td class="markdownTableBodyLeft">D13   </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">I2C   </th><th class="markdownTableHeadLeft">Original Pin Name   </th><th class="markdownTableHeadLeft">Map Pin Name    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SDA   </td><td class="markdownTableBodyLeft">PD1   </td><td class="markdownTableBodyLeft">D18    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SCL   </td><td class="markdownTableBodyLeft">PD0   </td><td class="markdownTableBodyLeft">D19   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md543"></a>
Flashing RIOT</h1>
<p>Flashing RIOT on the CoreRF is done using the SPI method. Using a cheap FT232H breakout board, connect the board as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">FT232H   </th><th class="markdownTableHeadLeft">Microduino CoreRF    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">D0   </td><td class="markdownTableBodyLeft">D13 (SCK)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">D1   </td><td class="markdownTableBodyLeft">D11 (MOSI)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">D2   </td><td class="markdownTableBodyLeft">D12 (MISO)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">D3   </td><td class="markdownTableBodyLeft">RST (Reset)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">3.3V   </td><td class="markdownTableBodyLeft">3.3V    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GND   </td><td class="markdownTableBodyLeft">GND   </td></tr>
</table>
<p>Now you can simply type</p>
<p><code>make flash BOARD=microduino-corerf</code></p>
<p>This should take care of everything!</p>
<p>You will need a separate adapter for UART:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">FT232R   </th><th class="markdownTableHeadLeft">Microduino CoreRF    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">TX   </td><td class="markdownTableBodyLeft">D0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">RX   </td><td class="markdownTableBodyLeft">D1   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md544"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md545"></a>
Using the external crystal oscillator (Transceiver Crystal Oscillator) and deep sleep</h2>
<p>When the external crystal oscillator is used as system clock and the device is put into deep sleep mode it seems that the clocks for all peripherals are enabled and set to the smallest divider (highest frequency). This leads to a higher power consumption. When the device should be put into deep sleep it is recommended to use the internal RC oscillator as system clock source.</p>
<h2><a class="anchor" id="autotoc_md546"></a>
Pin Change Interrupts</h2>
<p>More pins can be used for hardware interrupts using the Pin Change Interrupt feature. See <a class="el" href="group__boards__common__atmega.html">ATmega common</a> for details.</p>
<h2><a class="anchor" id="autotoc_md547"></a>
Debugging</h2>
<p>The ATmega128RFR1 supports JTAG debugging. To use the JTAG debugging an external JTAG debugger is required. There are several options for this MCU/board:</p>
<p><a href="http://www.atmel.com/tools/avrjtagicemkii.aspx">AVR JTAGICE mkII</a> <a href="http://www.atmel.com/tools/jtagice3.aspx">JTAGICE3</a> <a href="http://www.atmel.com/tools/avrdragon.aspx">AVR Dragon</a></p>
<p>Hint: The AVR Dragon is the <strike>cheapest</strike> least expensive debugger and also is compatible with almost every AVR MCU.</p>
<dl class="section warning"><dt>Warning</dt><dd>With the default fuse settings, on chip debugging is disabled.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If you are using a different debugger than the AVR Dragon, you have to export the <code>AVR_DEBUGDEVICE</code> environment variable to the required flag to pass to AVaRICE, e.g. when using the Atmel-ICE you have to export <code>AVR_DEBUGDEVICE=--edbg</code>. If the debug device is not connected via USB, you also need to export <code>AVR_DEBUGINTERFACE</code> to the correct value.</dd></dl>
<h3><a class="anchor" id="autotoc_md548"></a>
JTAG Pin Mapping</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Pin   </th><th class="markdownTableHeadLeft">Pin Label   </th><th class="markdownTableHeadLeft">Signal   </th><th class="markdownTableHeadLeft">AVR Dragon Pin    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">PF7   </td><td class="markdownTableBodyLeft">A0   </td><td class="markdownTableBodyLeft">TDI   </td><td class="markdownTableBodyLeft">JTAG-9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">PF6   </td><td class="markdownTableBodyLeft">A1   </td><td class="markdownTableBodyLeft">TDO   </td><td class="markdownTableBodyLeft">JTAG-3    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">PF5   </td><td class="markdownTableBodyLeft">A2   </td><td class="markdownTableBodyLeft">TMS   </td><td class="markdownTableBodyLeft">JTAG-5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">PF4   </td><td class="markdownTableBodyLeft">A3   </td><td class="markdownTableBodyLeft">TCK   </td><td class="markdownTableBodyLeft">JTAG-1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">VDD   </td><td class="markdownTableBodyLeft">3V3   </td><td class="markdownTableBodyLeft">VTG   </td><td class="markdownTableBodyLeft">JTAG-4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GND   </td><td class="markdownTableBodyLeft">GND   </td><td class="markdownTableBodyLeft">GND   </td><td class="markdownTableBodyLeft">JTAG-2   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md549"></a>
Fuse Settings</h3>
<p>Be aware that changing the fuse settings can "brick" your MCU, e.g. if you select a different clock setting that is not available on your board. Or if you disable all options for programming the MCU.</p>
<p>You can always de-brick your MCU using high voltage programming mode, which can also be done using the AVR Dragon. But being careful to not brick your MCU in the first place is clearly the better option ;-)</p>
<p>In the following it is assumed that you connect the Dragon ISP header to the Microduino CoreRF for ISP programming.</p>
<h4><a class="anchor" id="autotoc_md550"></a>
Default Fuse Settings</h4>
<p>The default fuse settings of the Microduino CoreRF are: <code>E:F5, H:DA, L:FF</code>. These settings can be restored via from the OCD settings via:</p>
<div class="fragment"><div class="line">avrdude -c dragon_isp -p m128rfa1 -U hfuse:w:0xda:m</div>
</div><!-- fragment --><p>If you touched other fuse settings, you can restore the fuse settings using:</p>
<div class="fragment"><div class="line">avrdude -c dragon_isp -p m128rfa1 -U efuse:w:0xf5:m -U hfuse:w:0xda:m -U lfuse:w:0xff:m</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md551"></a>
On-Chip Debugging Fuse Settings</h3>
<p>To enable on-chip debugging, the <code>JTAGEN</code> (enable JTAG) and the <code>OCDEN</code> (enable on-chip debugging) bits should be set: <code>E:F5, H:1A, L:FF</code>. This can be done (when starting with the default settings) via:</p>
<div class="fragment"><div class="line">avrdude -c dragon_isp -p m128rfa1 -U hfuse:w:0x1a:m</div>
</div><!-- fragment --> <table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="microduino-corerf_2include_2board_8h.html">board.h</a></td></tr>
<tr class="memdesc:microduino-corerf_2include_2board_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific definitions for the Microduino CoreRF board. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boards_2microduino-corerf_2include_2periph__conf_8h.html">periph_conf.h</a></td></tr>
<tr class="memdesc:boards_2microduino-corerf_2include_2periph__conf_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peripheral MCU configuration for the Microduino CoreRF board. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->

    </div>
  </body>
</html>
