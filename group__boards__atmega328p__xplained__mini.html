<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RIOT OS: ATmega328p Xplained Mini</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<!-- <script type="text/javascript" src="jquery.js"></script> -->
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<!-- <link href="/pagefind/pagefind-ui.css" rel="stylesheet"> -->
<script src="/pagefind/pagefind-ui.js"></script>
<script>
  // Check whether the PagefindUI class is available
  if (typeof PagefindUI === 'undefined') {
    console.error('PagefindUI class is not available | Dev Build');
  } else {
    // // Remove the "searchstub" element and initialize the PagefindUI class
    // document.getElementById("#searchstub").remove();
    // Initialize the PagefindUI class with the element id "search"
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
  }
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="global.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <script>
    // Print the data within the NAVTREE variable from the navtreedata.js file
    var navtree = NAVTREE;
    console.log(navtree);
  </script>
<div class="flex flex-row gap-4 w-screen font-sans text-lg max-h-screen overscroll-contain justify-items-stretch bg-neutral-900">
  <!--Sidebar-->
  <div data-pagefind-ignore="all" class="w-1/3 max-w-md flex-auto h-screen bg-neutral-800 ring-2 ring-neutral-700 shadow-neutral-800 shadow-2xl rounded-xl p-3 ml-1 my-2 mr-3 flex flex-col justify-around">
    <div id="top" class="justify-self-center content-center items-center place-content-center">
      <img alt="Logo" src="riot-logo.svg"/>
      <div id="projectbrief">
        The friendly Operating System for the Internet of Things
      </div>
    </div>
    <div id="search" class="place-content-center" class="overflow-y-scroll max-h-64 bg-slate-400 ring-2 ring-white text-white" >
      <h1>Searchbar via Pagefind</h1>
      <!-- <div id="searchstub" class="flex items-center border border-gray-300 rounded-lg p-2 shadow-sm">
        <input type="text" placeholder="Search is only available in Production Build ..." class="flex-grow p-2 outline-none">
      </div> -->
    </div>
    <div id="navtree">
      <script>
        // The navtree variable is always a pair of two elements (key, value)
        // The key is the name we should display and the value is the link to the page
        // Generate the navtree from the navtreedata.js file and put it under the navtree div
        var navtree = NAVTREE[0][2];
        var navtreeHTML = "<h1>Navigation based on Doxygen</h1> <ul>";
        for (var i = 0; i < navtree.length; i++) {
          navtreeHTML += "<li><a href='" + navtree[i][1] + "'>" + navtree[i][0] + "</a></li>";
          if (i == 5) {
            navtreeHTML += '<li><h3 class="ring-2 ring-white"> Random Insert for Demonstration </h3></li>';
          }
        }
        navtreeHTML += "</ul>";
        document.getElementById("navtree").innerHTML = navtreeHTML;
      </script>
    </div>
    <ul>
      <li class="footer">
        Generated on Tue Sep 24 2024 11:16:26 by 
          <a href="http://www.doxygen.org/index.html">
            Doxygen
          </a> 
        1.12.0
      </li>
    </ul>
  </div>
  <!--Main Content-->
  <div class="hidden">
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__boards__atmega328p__xplained__mini.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle"><div class="title">ATmega328p Xplained Mini<div class="ingroups"><a class="el" href="group__boards.html">Boards</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Support for using the ATmega328p Xplained Mini board  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Support for using the ATmega328p Xplained Mini board </p>
<h2><a class="anchor" id="autotoc_md204"></a>
Overview</h2>
<p>The ATmega328p MCU is most popular in the Arduino UNO. The Xplained Mini board is a reduced version of Arduino UNO with a EDBG CMSIS-DAP programmer.</p>
<p>The Xplained Mini has two internal oscillators, one clocked at 8MHz and one at 128kHz and one external 16/8MHz clock at 5/3.3V. The default fuses of the Xplained Mini are configured to use external 16MHz oscillator. This default configuration uses a 5.0V supply voltage.</p>
<h3><a class="anchor" id="autotoc_md205"></a>
MCU</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">MCU   </th><th class="markdownTableHeadLeft">ATmega328p    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Family   </td><td class="markdownTableBodyLeft">AVR/ATmega    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Vendor   </td><td class="markdownTableBodyLeft">Microchip (previously Atmel)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">RAM   </td><td class="markdownTableBodyLeft">2KiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Flash   </td><td class="markdownTableBodyLeft">32KiB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">EEPROM   </td><td class="markdownTableBodyLeft">1KiB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Frequency   </td><td class="markdownTableBodyLeft">1MHz/8MHz/16MHz    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Timers   </td><td class="markdownTableBodyLeft">3 (2x 8bit, 1x 16bit)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ADCs   </td><td class="markdownTableBodyLeft">6 analog input pins    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">UARTs   </td><td class="markdownTableBodyLeft">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SPIs   </td><td class="markdownTableBodyLeft">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">I2Cs   </td><td class="markdownTableBodyLeft">1 (called TWI)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Vcc   </td><td class="markdownTableBodyLeft">5.0V USB (when clocked at 16MHz)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Datasheet   </td><td class="markdownTableBodyLeft"><a href="http://ww1.microchip.com/downloads/en/DeviceDoc/ATmega48A-PA-88A-PA-168A-PA-328-P-DS-DS40002061A.pdf">Official datasheet</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">User Manual   </td><td class="markdownTableBodyLeft"><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/ATmega328P-Xplained-Mini-UG-DS50002659B.pdf">User Manual</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Design files   </td><td class="markdownTableBodyLeft"><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/ATmega328P-Xplained-Mini_Design-Documentation.zip">Design files</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">AN 42552   </td><td class="markdownTableBodyLeft"><a href="http://ww1.microchip.com/downloads/en/Appnotes/Atmel-42552-AVR-for-IoT-Using-megaAVR-ATWINC1500-802-11bgn-WiFi-Network-Controller-Module_ApplicationNote_AT13041.pdf">AN_42552</a>   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md206"></a>
Clock Frequency</h3>
<p>The Xplained Mini has two internal oscillators clocked at 8MHz and at 128kHz that allow it to be operated without any external clock source or crystal. By default the fuses are configured to use the external 16MHz clock without clock divider resulting in a CPU clock speed of 16MHz. There is no need to clear the <code>CKDIV8</code> fuse once it is already done. </p><pre class="fragment">default fuses: (E:FC, H:D1, L:E0)
</pre><p>This "board" is configured to use 16MHz as core clock, so that the ATmega328p runs at the highest frequency possible using the external clock source.</p>
<p>By setting the environment variable <code>ATMEGA328P_CLOCK</code> to a custom frequency in Hz (e.g. <code>1000000</code> for 1MHz), this core clock can be changed easily. Refer to the datasheet on how to configure the ATmega328p to use an external crystal, an external clock source or the clock divider.</p>
<h3><a class="anchor" id="autotoc_md207"></a>
Relation Between Supply Voltage, Clock Frequency and Power Consumption</h3>
<p>A higher supply voltage results in a higher current drawn. Thus, lower power consumption can be achieved by using a lower supply voltage. However, higher clock frequencies require higher supply voltages for reliable operation.</p>
<p>The lowest possible supply voltage at 8 MHz is 2.7V (with some safety margin), which results in an active supply current of less than 3 mA (about 8 mW power consumption) according to the datasheet. At 1 MHz core clock a supply voltage of 1.8V is possible resulting in an active supply current of less than 0.3 mA (about 0.5 mW power consumption). For more details, refer to the official datasheet.</p>
<h2><a class="anchor" id="autotoc_md208"></a>
Flashing the Device</h2>
<p>The only requirement is <code>avrdude</code> tool installed: </p><pre class="fragment">make BOARD=atmega328P-xplained-mini flash
</pre><h2><a class="anchor" id="autotoc_md209"></a>
Serial Terminal</h2>
<p>The AVR Xplained Mini already have an USB CDC converter build in. So, simple type to get terminal: </p><pre class="fragment">make BOARD=atmega328P-xplained-mini term
</pre><h2><a class="anchor" id="autotoc_md210"></a>
On-Chip Debugging (OCD)</h2>
<p>E.g. with the AVR Xplained Mini and <a href="http://avarice.sourceforge.net/">AVaRICE</a> you can debug the ATmega328P using the debugWIRE interface. Compared to the ATmega MCUs with JTAG interface the debug facilities are however significantly reduced: Only a single hardware breakpoint and no watchpoints are supported. The hardware breakpoint is used for single-stepping. If you set breakpoints, the AVR Xplained Mini will transparently replace the instruction to break upon with a break instruction. Once the breakpoint is hit, the break instruction is overwritten with the original instruction. Thus, every breakpoint hit cause two flash cycles to be performed, which not only results in a slow debugging experience, but also causes significant wear.</p>
<p>In order to enable debugWIRE run, replace <code>&lt;PROGRAMMER&gt;</code> with the <code>xplainedmini_dw</code>: </p><pre class="fragment">avrdude -c &lt;PROGRAMMER&gt; -p m328p -U hfuse:w:0x99:m
</pre><p>You can disable it again via: </p><pre class="fragment">avrdude -c &lt;PROGRAMMER&gt; -p m328p -U hfuse:w:0xd9:m
</pre><dl class="section warning"><dt>Warning</dt><dd>As the reset pin is repurposed for debugWIRE, a regular ISP will not be able to disable the debugWIRE interface anymore. The AVR Xplained Mini can temporary disable the debugWIRE interface via a debugWIRE command and avrdude will do so when debugWIRE is used.</dd></dl>
<p>For debugging, the ATmega328P Xplained Mini already have a debugger. Once the debugWIRE is enabled via the fuse settings, you can start debugging via: </p><pre class="fragment">make debug
</pre><p>If this fails after flashing the ATmega328P, it is like due to debugWIRE being temporary disabled by avrdude in order to use the ISP feature. Perform a cold boot and the ATmega328P will have debugWIRE enabled again.</p>
<dl class="section note"><dt>Note</dt><dd>If you are using a different debugger than the AVR Xplained Mini, you have to export the <code>AVR_DEBUGDEVICE</code> environment variable to the required flag to pass to AVaRICE, e.g. when using the Atmel-ICE you have to export <code>AVR_DEBUGDEVICE=--edbg</code>. If the debug device is not connected via USB, you also need to export <code>AVR_DEBUGINTERFACE</code> to the correct value.</dd></dl>
<p>There is a how to ATWINC1500 802.11 b/g/n Wi-Fi <a class="el" href="structNetwork.html" title="Network struct within mqtt paho.">Network</a> with this board (AN_42552). </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="atmega328p-xplained-mini_2include_2board_8h.html">board.h</a></td></tr>
<tr class="memdesc:atmega328p-xplained-mini_2include_2board_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific definitions for the standalone ATmega328p "board". <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="atmega328p-xplained-mini_2include_2gpio__params_8h.html">gpio_params.h</a></td></tr>
<tr class="memdesc:atmega328p-xplained-mini_2include_2gpio__params_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration of SAUL mapped GPIO pins. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boards_2atmega328p-xplained-mini_2include_2periph__conf_8h.html">periph_conf.h</a></td></tr>
<tr class="memdesc:boards_2atmega328p-xplained-mini_2include_2periph__conf_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peripheral MCU configuration for the ATmega328p xplained mini "board". <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->

    </div>
  </body>
</html>
