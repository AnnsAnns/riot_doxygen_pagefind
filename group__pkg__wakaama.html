<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RIOT OS: LwM2M - Lightweight Machine to Machine</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<!-- <script type="text/javascript" src="jquery.js"></script> -->
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<!-- <link href="/pagefind/pagefind-ui.css" rel="stylesheet"> -->
<script src="/pagefind/pagefind-ui.js"></script>
<script>
  // Check whether the PagefindUI class is available
  if (typeof PagefindUI === 'undefined') {
    console.error('PagefindUI class is not available | Dev Build');
  } else {
    // // Remove the "searchstub" element and initialize the PagefindUI class
    // document.getElementById("#searchstub").remove();
    // Initialize the PagefindUI class with the element id "search"
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
  }
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="global.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <script>
    // Print the data within the NAVTREE variable from the navtreedata.js file
    var navtree = NAVTREE;
    console.log(navtree);
  </script>
<div class="flex flex-row gap-4 w-screen font-sans text-lg max-h-screen overscroll-contain justify-items-stretch bg-neutral-900">
  <!--Sidebar-->
  <div data-pagefind-ignore="all" class="w-1/3 max-w-md flex-auto h-screen bg-neutral-800 ring-2 ring-neutral-700 shadow-neutral-800 shadow-2xl rounded-xl p-3 ml-1 my-2 mr-3 flex flex-col justify-around">
    <div id="top" class="justify-self-center content-center items-center place-content-center">
      <img alt="Logo" src="riot-logo.svg"/>
      <div id="projectbrief">
        The friendly Operating System for the Internet of Things
      </div>
    </div>
    <div id="search" class="place-content-center" class="overflow-y-scroll max-h-64 bg-slate-400 ring-2 ring-white text-white" >
      <h1>Searchbar via Pagefind</h1>
      <!-- <div id="searchstub" class="flex items-center border border-gray-300 rounded-lg p-2 shadow-sm">
        <input type="text" placeholder="Search is only available in Production Build ..." class="flex-grow p-2 outline-none">
      </div> -->
    </div>
    <div id="navtree">
      <script>
        // The navtree variable is always a pair of two elements (key, value)
        // The key is the name we should display and the value is the link to the page
        // Generate the navtree from the navtreedata.js file and put it under the navtree div
        var navtree = NAVTREE[0][2];
        var navtreeHTML = "<h1>Navigation based on Doxygen</h1> <ul>";
        for (var i = 0; i < navtree.length; i++) {
          navtreeHTML += "<li><a href='" + navtree[i][1] + "'>" + navtree[i][0] + "</a></li>";
          if (i == 5) {
            navtreeHTML += '<li><h3 class="ring-2 ring-white"> Random Insert for Demonstration </h3></li>';
          }
        }
        navtreeHTML += "</ul>";
        document.getElementById("navtree").innerHTML = navtreeHTML;
      </script>
    </div>
    <ul>
      <li class="footer">
        Generated on Tue Sep 24 2024 11:16:26 by 
          <a href="http://www.doxygen.org/index.html">
            Doxygen
          </a> 
        1.12.0
      </li>
    </ul>
  </div>
  <!--Main Content-->
  <div class="hidden">
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__pkg__wakaama.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#groups">Topics</a>  </div>
  <div class="headertitle"><div class="title">LwM2M - Lightweight Machine to Machine<div class="ingroups"><a class="el" href="group__pkg.html">Packages</a> &#124; <a class="el" href="group__net.html">Networking</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>LwM2M implementation based on the Wakaama package  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>LwM2M implementation based on the Wakaama package </p>
<p>Lightweight Machine to Machine is a device management protocol designed for sensor networks, designed for remote management of M2M devices and related service enablement. It defines an extensible resource and data model and builds top of CoAP. LwM2M has been specified by the OMA SpecWorks Device Management Working Group. The specification is freely available <a href="http://openmobilealliance.org/wp/index.html">here</a>.</p>
<p>For a list of the supported objects see <a class="el" href="group__lwm2m__objects.html">LwM2M Object implementations</a>. The client implementation is based on the Eclipse <a href="https://github.com/eclipse/wakaama">Wakaama project</a></p>
<h2><a class="anchor" id="autotoc_md1926"></a>
Usage</h2>
<p>A LwM2M Client organizes resources as object instances. The LwM2M engine is independent of the objects that the client exposes, but it needs at least 3 mandatory ones: <a class="el" href="group__lwm2m__objects__device.html">Device object</a>, <a class="el" href="group__lwm2m__objects__security.html">Security object</a> and a Server object.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="lwm2m__client_8h.html">lwm2m_client.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="lwm2m__client__objects_8h.html">lwm2m_client_objects.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="security_8h.html">objects/security.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="pkg_2wakaama_2include_2objects_2device_8h.html">objects/device.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="credman_8h.html">net/credman.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// hold references to object handles</span></div>
<div class="line">lwm2m_object_t *obj_list[3];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// LwM2M Client instance</span></div>
<div class="line"><a class="code hl_struct" href="structlwm2m__client__data__t.html">lwm2m_client_data_t</a> client_data;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// short ID for internal reference of the server</span></div>
<div class="line"><span class="preprocessor">#define CONFIG_LWM2M_SERVER_SHORT_ID 1</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// initiate the LwM2M Client</span></div>
<div class="line">   <a class="code hl_function" href="group__lwm2m__client.html#ga7496736a9754f07edea52b0e4ab2e9c4">lwm2m_client_init</a>(&amp;client_data);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// arguments for instantiating a security object</span></div>
<div class="line">   <a class="code hl_struct" href="structlwm2m__obj__security__args.html">lwm2m_obj_security_args_t</a> args = {</div>
<div class="line">       .server_id = CONFIG_LWM2M_SERVER_SHORT_ID,</div>
<div class="line">       .server_uri = <span class="stringliteral">&quot;coap://[fd00:dead:beef::1]:5683&quot;</span>,</div>
<div class="line">       .security_mode = <a class="code hl_define" href="group__lwm2m__objects__security.html#ga70a6f5afd228e42a5ed0494276df1e21">LWM2M_SECURITY_MODE_NONE</a>,</div>
<div class="line">       .is_bootstrap = <span class="keyword">false</span>,</div>
<div class="line">       .client_hold_off_time = 5,</div>
<div class="line">       .bootstrap_account_timeout = 0</div>
<div class="line">   };</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// get the Security object handle</span></div>
<div class="line">   obj_list[0] = <a class="code hl_function" href="group__lwm2m__objects__security.html#ga73b38a32ea3203d845d8e3824ad47667">lwm2m_object_security_init</a>(&amp;client_data);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// create a new Security object instance</span></div>
<div class="line">   <span class="keywordtype">int</span> res = <a class="code hl_function" href="group__lwm2m__objects__security.html#gafd3eaae1ec622a3529f7963acc166a4f">lwm2m_object_security_instance_create</a>(&amp;args, 1);</div>
<div class="line">   <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line">       puts(<span class="stringliteral">&quot;Could not instantiate the security object&quot;</span>);</div>
<div class="line">       <span class="keywordflow">return</span>;</div>
<div class="line">   }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// get the Server object handle (only single instance for now)</span></div>
<div class="line">   obj_list[1] = <a class="code hl_function" href="lwm2m__client__objects_8h.html#a937b65273fe5d85d59809c786756965a">lwm2m_client_get_server_object</a>(&amp;client_data, CONFIG_LWM2M_SERVER_SHORT_ID);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// device object has a single instance. All the information for now is defined at compile-time</span></div>
<div class="line">   obj_list[2] = lwm2m_object_device_get();</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// run the LwM2M client</span></div>
<div class="line">   <a class="code hl_function" href="group__lwm2m__client.html#ga8ea2ae6857459319cf33256f9392d7ae">lwm2m_client_run</a>(&amp;client_data, obj_list, <a class="code hl_define" href="container_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a>(obj_list);</div>
<div class="line">}</div>
<div class="ttc" id="acontainer_8h_html_a25f003de16c08a4888b69f619d70f427"><div class="ttname"><a href="container_8h.html#a25f003de16c08a4888b69f619d70f427">ARRAY_SIZE</a></div><div class="ttdeci">#define ARRAY_SIZE(a)</div><div class="ttdoc">Calculate the number of elements in a static array.</div><div class="ttdef"><b>Definition</b> <a href="container_8h_source.html#l00083">container.h:83</a></div></div>
<div class="ttc" id="acredman_8h_html"><div class="ttname"><a href="credman_8h.html">credman.h</a></div><div class="ttdoc">(D)TLS credentials management module definitions</div></div>
<div class="ttc" id="agroup__lwm2m__client_html_ga7496736a9754f07edea52b0e4ab2e9c4"><div class="ttname"><a href="group__lwm2m__client.html#ga7496736a9754f07edea52b0e4ab2e9c4">lwm2m_client_init</a></div><div class="ttdeci">void lwm2m_client_init(lwm2m_client_data_t *client_data)</div><div class="ttdoc">Initializes a LwM2M client.</div></div>
<div class="ttc" id="agroup__lwm2m__client_html_ga8ea2ae6857459319cf33256f9392d7ae"><div class="ttname"><a href="group__lwm2m__client.html#ga8ea2ae6857459319cf33256f9392d7ae">lwm2m_client_run</a></div><div class="ttdeci">lwm2m_context_t * lwm2m_client_run(lwm2m_client_data_t *client_data, lwm2m_object_t *obj_list[], uint16_t obj_numof)</div><div class="ttdoc">Starts a LwM2M client.</div></div>
<div class="ttc" id="agroup__lwm2m__objects__security_html_ga70a6f5afd228e42a5ed0494276df1e21"><div class="ttname"><a href="group__lwm2m__objects__security.html#ga70a6f5afd228e42a5ed0494276df1e21">LWM2M_SECURITY_MODE_NONE</a></div><div class="ttdeci">#define LWM2M_SECURITY_MODE_NONE</div><div class="ttdoc">No security mode.</div><div class="ttdef"><b>Definition</b> <a href="security_8h_source.html#l00199">security.h:199</a></div></div>
<div class="ttc" id="agroup__lwm2m__objects__security_html_ga73b38a32ea3203d845d8e3824ad47667"><div class="ttname"><a href="group__lwm2m__objects__security.html#ga73b38a32ea3203d845d8e3824ad47667">lwm2m_object_security_init</a></div><div class="ttdeci">lwm2m_object_t * lwm2m_object_security_init(lwm2m_client_data_t *client_data)</div><div class="ttdoc">Initialize the Security object.</div></div>
<div class="ttc" id="agroup__lwm2m__objects__security_html_gafd3eaae1ec622a3529f7963acc166a4f"><div class="ttname"><a href="group__lwm2m__objects__security.html#gafd3eaae1ec622a3529f7963acc166a4f">lwm2m_object_security_instance_create</a></div><div class="ttdeci">int lwm2m_object_security_instance_create(const lwm2m_obj_security_args_t *args, int32_t instance_id)</div><div class="ttdoc">Create a new Security instance and add it to the object list.</div></div>
<div class="ttc" id="alwm2m__client_8h_html"><div class="ttname"><a href="lwm2m__client_8h.html">lwm2m_client.h</a></div><div class="ttdoc">Definitions and public API for a LwM2M client using Wakaama.</div></div>
<div class="ttc" id="alwm2m__client__objects_8h_html"><div class="ttname"><a href="lwm2m__client__objects_8h.html">lwm2m_client_objects.h</a></div><div class="ttdoc">Public API and definitions for the helper functions to interact with basic objects from a LwM2M clien...</div></div>
<div class="ttc" id="alwm2m__client__objects_8h_html_a937b65273fe5d85d59809c786756965a"><div class="ttname"><a href="lwm2m__client__objects_8h.html#a937b65273fe5d85d59809c786756965a">lwm2m_client_get_server_object</a></div><div class="ttdeci">lwm2m_object_t * lwm2m_client_get_server_object(lwm2m_client_data_t *client_data, int server_id)</div><div class="ttdoc">Creates a LwM2M server object with the default configuration from net/lwm2m.h.</div></div>
<div class="ttc" id="apkg_2wakaama_2include_2objects_2device_8h_html"><div class="ttname"><a href="pkg_2wakaama_2include_2objects_2device_8h.html">device.h</a></div></div>
<div class="ttc" id="asecurity_8h_html"><div class="ttname"><a href="security_8h.html">security.h</a></div></div>
<div class="ttc" id="astructlwm2m__client__data__t_html"><div class="ttname"><a href="structlwm2m__client__data__t.html">lwm2m_client_data_t</a></div><div class="ttdoc">LwM2M client descriptor.</div><div class="ttdef"><b>Definition</b> <a href="lwm2m__client_8h_source.html#l00070">lwm2m_client.h:70</a></div></div>
<div class="ttc" id="astructlwm2m__obj__security__args_html"><div class="ttname"><a href="structlwm2m__obj__security__args.html">lwm2m_obj_security_args</a></div><div class="ttdoc">Arguments for a new Security object instance creation (lwm2m_object_security_instance_create).</div><div class="ttdef"><b>Definition</b> <a href="security_8h_source.html#l00311">security.h:311</a></div></div>
</div><!-- fragment --><p>The LwM2M Client will connect to the specified LwM2M server and register itself. After that, the server will be able to perform Read, Write, Create, Delete, Execute and Observe operations on the resources.</p>
<h3><a class="anchor" id="autotoc_md1927"></a>
DTLS support</h3>
<p>With the configuration above plain CoAP is used. To secure the connection with the LwM2M Server, a credential is needed in the Security object instance. To enable DTLS support add the module <code>wakaama_client_dtls</code>. This uses the <a class="el" href="group__net__sock__dtls.html">DTLS sock API</a>, so you will need to select an implementation of it (e.g. <code>USEPKG += tinydtls</code>). Currently Pre-Shared Key (PSK) and Raw Public Key (RPK) modes are supported.</p>
<p>To see how to use DTLS credentials, go to the usage section of <a class="el" href="group__lwm2m__objects__security.html">Security LwM2M object</a>.</p>
<h3><a class="anchor" id="autotoc_md1928"></a>
Using a LwM2M Bootstrap Server</h3>
<p>A bootstrap server gives a LwM2M deployment more flexibility. Information on how to connect to the LwM2M bootstrap server is defined at compile-time in the client (including URI and potentially needed credentials). The client connects to the bootstrap server on boot, which installs on the node the information needed to connect to the LwM2M servers.</p>
<p>To enable bootstrap support, set the <code>LWM2M_BOOTSTRAP</code> option on Kconfig or set the CFLAG <code>CONFIG_LWM2M_BOOTSTRAP=1</code>. You will also need to specify during the security object instantiation that the information corresponds to a bootstrap server. DTLS is also supported for the bootstrap server:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structlwm2m__obj__security__args.html">lwm2m_obj_security_args_t</a> args = {</div>
<div class="line">    .server_id = 1,</div>
<div class="line">    .server_uri = <span class="stringliteral">&quot;coaps://[fd00:dead:beef::1]:5684&quot;</span>,</div>
<div class="line">    .security_mode = <a class="code hl_define" href="group__lwm2m__objects__security.html#ga15d86892263343d84b480e9072da09b2">LWM2M_SECURITY_MODE_PRE_SHARED_KEY</a>,</div>
<div class="line">    .pub_key_or_id = psk_id,</div>
<div class="line">    .pub_key_or_id_len = <span class="keyword">sizeof</span>(psk_id) - 1,</div>
<div class="line">    .secret_key = psk_key,</div>
<div class="line">    .secret_key_len = <span class="keyword">sizeof</span>(psk_key) - 1,</div>
<div class="line">    .is_bootstrap = <span class="keyword">true</span>,</div>
<div class="line">    .client_hold_off_time = 5,</div>
<div class="line">    .bootstrap_account_timeout = 0</div>
<div class="line">};</div>
<div class="ttc" id="agroup__lwm2m__objects__security_html_ga15d86892263343d84b480e9072da09b2"><div class="ttname"><a href="group__lwm2m__objects__security.html#ga15d86892263343d84b480e9072da09b2">LWM2M_SECURITY_MODE_PRE_SHARED_KEY</a></div><div class="ttdeci">#define LWM2M_SECURITY_MODE_PRE_SHARED_KEY</div><div class="ttdoc">Pre-Shared keys mode.</div><div class="ttdef"><b>Definition</b> <a href="security_8h_source.html#l00184">security.h:184</a></div></div>
</div><!-- fragment --><p>Keep into account, that some Sock DTLS implementations may need some extra configuration to handle multiple connections. See the <code>example/wakaama</code> Makefile. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Topics</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lwm2m__objects__common.html">Common LwM2M Object functionalities</a></td></tr>
<tr class="memdesc:group__lwm2m__objects__common"><td class="mdescLeft">&#160;</td><td class="mdescRight"><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lwm2m__client.html">LwM2M Client using Wakaama</a></td></tr>
<tr class="memdesc:group__lwm2m__client"><td class="mdescLeft">&#160;</td><td class="mdescRight"><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lwm2m__objects.html">LwM2M Object implementations</a></td></tr>
<tr class="memdesc:group__lwm2m__objects"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementations of LwM2M objects using Wakaama. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lwm2m__platform.html">Platform adaption for Wakaama package</a></td></tr>
<tr class="memdesc:group__lwm2m__platform"><td class="mdescLeft">&#160;</td><td class="mdescRight"><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__lwm2m__client__config.html">Wakaama LwM2M Client configuration</a></td></tr>
<tr class="memdesc:group__lwm2m__client__config"><td class="mdescLeft">&#160;</td><td class="mdescRight"><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->

    </div>
  </body>
</html>
